import{r as e,c as a,a as s,w as l,i as o,o as t,b as u,d as r,e as n,f as i,g as d,I as p,t as c,h as m,s as f,j as g,k as v,l as _,m as h,n as k}from"./index-xJ6XffpG.js";import{_ as w}from"./logo.C0cGNqUp.js";import{o as y,a as b}from"./uni-app.es.WGLDDGg_.js";import{l as j}from"./user.Cx3nd9dg.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./request.DmWrvmgp.js";const x=V({__name:"login",setup(V){const x=e({username:"",password:""}),I=e(!1),C=e(!1),T=e(""),U=()=>{I.value=!I.value},q=a((()=>!x.value.username||!x.value.password||C.value)),A=()=>{q.value?f({title:"请填写完整信息",icon:"none"}):(T.value="",C.value=!0,j(x.value.username,x.value.password).then((e=>{const{token:a,userId:s,username:l}=e.data;g(a),v({userId:s,username:l}),f({title:"登录成功",icon:"success",duration:1500}),setTimeout((()=>{_({url:"/pages/home/home",fail:e=>{console.error("跳转失败:",e),h({url:"/pages/home/home"})}})}),1500)})).catch((e=>{T.value=e.message||"登录失败，请重试",f({title:T.value,icon:"none"})})).finally((()=>{C.value=!1})))},F=()=>{k({url:"/pages/register/register",fail:e=>{console.error("navigateTo失败:",e),h({url:"/pages/register/register"})}})};return y((()=>{console.log("登录页面加载完成")})),b((()=>{console.log("登录页面显示"),T.value="",C.value=!1})),(e,a)=>{const f=r,g=n,v=o,_=p,h=m;return t(),s(v,{class:"login-page"},{default:l((()=>[u(v,{class:"login-header"},{default:l((()=>[u(f,{class:"logo",src:w,mode:"aspectFit"}),u(g,{class:"app-title"},{default:l((()=>[i("科研助手")])),_:1}),u(g,{class:"app-subtitle"},{default:l((()=>[i("AI驱动的学术研究助手")])),_:1})])),_:1}),u(v,{class:"login-form"},{default:l((()=>[u(v,{class:"input-item"},{default:l((()=>[u(g,{class:"input-label"},{default:l((()=>[i("用户名/邮箱")])),_:1}),u(_,{class:"input-field",type:"text",modelValue:x.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.username=e),placeholder:"请输入用户名或邮箱"},null,8,["modelValue"])])),_:1}),u(v,{class:"input-item"},{default:l((()=>[u(g,{class:"input-label"},{default:l((()=>[i("密码")])),_:1}),u(v,{class:"password-input-wrapper"},{default:l((()=>[u(_,{class:"input-field",type:I.value?"text":"password",modelValue:x.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.password=e),placeholder:"请输入密码"},null,8,["type","modelValue"]),u(g,{class:"eye-icon",onClick:U},{default:l((()=>[i(c(I.value?"👁️":"👁️‍🗨️"),1)])),_:1})])),_:1})])),_:1}),T.value?(t(),s(v,{key:0,class:"error-message"},{default:l((()=>[i(c(T.value),1)])),_:1})):d("",!0),u(h,{class:"login-button",onClick:A,disabled:C.value},{default:l((()=>[C.value?(t(),s(v,{key:1,class:"loading-spinner"})):(t(),s(g,{key:0},{default:l((()=>[i("登录")])),_:1}))])),_:1},8,["disabled"]),u(v,{class:"action-links"},{default:l((()=>[u(g,{class:"register-link",onClick:F},{default:l((()=>[i("注册新账号")])),_:1})])),_:1})])),_:1}),u(v,{class:"login-footer"},{default:l((()=>[u(g,{class:"copyright"},{default:l((()=>[i("© 2023 论文助手 - 科研好帮手")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-8bd43081"]]);export{x as default};
