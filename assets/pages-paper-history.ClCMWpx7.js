import{r as a,H as s,a as e,w as t,i as l,o as A,b as i,e as o,f as u,d as n,t as r,h as c,G as I,S as g,u as B,F as d,v as p,g as Q,n as m,s as C}from"./index-xJ6XffpG.js";import{_ as f,a as E,b as D}from"./right.rGMJBKf1.js";import{o as h,b as y,c as F}from"./uni-app.es.WGLDDGg_.js";import{P as k}from"./PageHeader.BEnvkDdC.js";import{a as S}from"./paper.CyxWibfi.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./IconImage.CFxWE55B.js";import"./request.DmWrvmgp.js";const R=U({__name:"history",setup(U){const R=a([]),J=a(1),b=a(10),w=a(!0),H=a(!0),Y=a(!1),v=a("加载失败，请重试");h((()=>{K()}));const M=a=>{if(!a)return"";const s=new Date(a);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},K=(a=!0)=>{a&&(J.value=1,w.value=!0),(w.value||a)&&(H.value=!0,Y.value=!1,S(J.value,b.value,"completed").then((e=>{const{papers:t,total:l}=e.data,A=(t||[]).map((a=>({id:a.id,paperId:a.id,fileName:a.title||"未命名论文",fileSize:a.fileSize||"未知大小",analysisTime:a.uploadTime||"",keypointsCount:a.keypointsCount||0,thinkingCount:a.thinkingCount||0,directionsCount:a.directionsCount||0,hasModelImage:a.hasModelImage||!1,tags:a.tags||[]})));R.value=a?A:[...R.value,...A],w.value=R.value.length<l,w.value&&J.value++,H.value=!1,s()})).catch((a=>{console.error("获取历史记录失败:",a),Y.value=!0,v.value=a.message||"加载失败，请重试",H.value=!1,s(),a.isNetworkError&&(v.value="网络连接失败，请检查网络设置")})))},P=()=>{m({url:"/pages/upload/upload"})};return y((()=>{K(!0)})),F((()=>{w.value&&!H.value&&K(!1)})),(a,s)=>{const h=l,y=o,F=n,S=c,U=g;return A(),e(h,{class:"history-container"},{default:t((()=>[i(k,{title:"论文分析历史"}),H.value?(A(),e(h,{key:0,class:"loading-container"},{default:t((()=>[i(h,{class:"loading-spinner"}),i(y,{class:"loading-text"},{default:t((()=>[u("加载历史记录中...")])),_:1})])),_:1})):Y.value?(A(),e(h,{key:1,class:"error-container",onClick:K},{default:t((()=>[i(F,{src:f,class:"icon-large",mode:"aspectFit"}),i(y,{class:"error-title"},{default:t((()=>[u(r(v.value),1)])),_:1}),i(y,{class:"error-subtitle"},{default:t((()=>[u("点击重试")])),_:1}),i(S,{class:"retry-btn",onClick:I(K,["stop"])},{default:t((()=>[u("重新加载")])),_:1})])),_:1})):0===R.value.length?(A(),e(h,{key:2,class:"empty-container"},{default:t((()=>[i(F,{src:E,class:"icon-large",mode:"aspectFit"}),i(y,{class:"empty-title"},{default:t((()=>[u("暂无分析记录")])),_:1}),i(y,{class:"empty-subtitle"},{default:t((()=>[u("上传论文开始分析")])),_:1}),i(S,{class:"upload-btn",onClick:P},{default:t((()=>[u("开始分析")])),_:1})])),_:1})):(A(),e(U,{key:3,"scroll-y":"",class:"history-content"},{default:t((()=>[(A(!0),B(d,null,p(R.value,(a=>(A(),e(h,{key:a.id,class:"history-item",onClick:s=>{var e;(e=a.paperId)?m({url:`/pages/analysis/analysis?fileId=${e}`}):C({title:"无效的文件ID",icon:"none"})}},{default:t((()=>[i(h,{class:"history-icon"},{default:t((()=>[i(F,{src:"data:image/png;base64,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",class:"icon-medium",mode:"aspectFit"})])),_:1}),i(h,{class:"history-detail"},{default:t((()=>[i(h,{class:"history-header"},{default:t((()=>[i(y,{class:"history-title"},{default:t((()=>[u(r(a.fileName||"论文分析"),1)])),_:2},1024),i(y,{class:"history-time"},{default:t((()=>[u(r(M(a.analysisTime)),1)])),_:2},1024)])),_:2},1024),i(h,{class:"history-info"},{default:t((()=>[i(h,{class:"info-row"},{default:t((()=>[i(y,{class:"info-label"},{default:t((()=>[u("关键点")])),_:1}),i(y,{class:"info-value"},{default:t((()=>[u(r(a.keypointsCount||0)+"个",1)])),_:2},1024)])),_:2},1024),i(h,{class:"info-row"},{default:t((()=>[i(y,{class:"info-label"},{default:t((()=>[u("思路分析")])),_:1}),i(y,{class:"info-value"},{default:t((()=>[u(r(a.thinkingCount||0)+"个",1)])),_:2},1024)])),_:2},1024),i(h,{class:"info-row"},{default:t((()=>[i(y,{class:"info-label"},{default:t((()=>[u("研究方向")])),_:1}),i(y,{class:"info-value"},{default:t((()=>[u(r(a.directionsCount||0)+"个",1)])),_:2},1024)])),_:2},1024),a.hasModelImage?(A(),e(h,{key:0,class:"info-row"},{default:t((()=>[i(y,{class:"info-label"},{default:t((()=>[u("模型图")])),_:1}),i(y,{class:"info-value model-status"},{default:t((()=>[u("有")])),_:1})])),_:1})):Q("",!0)])),_:2},1024),a.tags&&a.tags.length?(A(),e(h,{key:0,class:"history-tags"},{default:t((()=>[(A(!0),B(d,null,p(a.tags,((a,s)=>(A(),e(y,{key:s,class:"history-tag"},{default:t((()=>[u(r(a),1)])),_:2},1024)))),128))])),_:2},1024)):Q("",!0)])),_:2},1024),i(h,{class:"history-action"},{default:t((()=>[i(F,{src:D,class:"icon-small",mode:"aspectFit"})])),_:1})])),_:2},1032,["onClick"])))),128)),i(h,{class:"bottom-space"})])),_:1}))])),_:1})}}},[["__scopeId","data-v-5753392b"]]);export{R as default};
